<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Neema's Recipes</title>
<script src="//ajax.googleapis.com/ajax/libs/angularjs/1.3.3/angular.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/angular.js/1.3.3/angular-route.min.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.4/css/bootstrap.min.css" integrity="sha384-2hfp1SzUoho7/TsGGGDaFdsuuDL0LX2hnUp6VkX3CUQ2K4K+xjboZdsXyp4oUHZj" crossorigin="anonymous">
<link href="/ui/style.css" rel="stylesheet" />
<script src="script.js"></script>
<style>
    .cimg{width:100%;height:200px;}
    .bg-img{-webkit-background-size: cover;
              -moz-background-size: cover;
              -o-background-size: cover;
              background-size: cover;
        background-position: 50% 50%;
        background-repeat: no-repeat;
    }
    
    
</style>
</head>
<body>


<nav class="navbar navbar-static-top navbar-dark bg-inverse">
      <a class="navbar-brand" href="/">Neemas</a>
      <ul class="nav navbar-nav f-right">
        
        <li class="nav-item login_lnk">
          <a class="nav-link" href="#" data-toggle="modal" data-target="#login-modal">Login</a>
        </li>
        <li class="nav-item logout_lnk" style="display: none">
          <a class="nav-link" href="/logout" id="logoutLink">Logout</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">Contact</a>
        </li>
      </ul>
    </nav>

<!-- login model -->
<div class="modal fade" id="login-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;">
        <div class="modal-dialog">
        <div class="loginmodal-container">
          <h1>Login to Your Account</h1><br>
          <form id="loginForm" data-toggle="validator" role="form">
          <div class="form-group">
            <div class="controls">
              <input type="text" class="form-control" id="mod-uname" name="user[name]" placeholder="Email" required data-error="Please enter a valid email"/>
              <p class="help-block with-errors"></p>
            </div>
          </div>
          <input type="password" name="user[pass]" placeholder="Password" required>
          <input type="submit" name="login" id="loginSubmit" class="login loginmodal-submit" value="Login">
          </form>
          
          <div class="login-help">
          <a href="/register">Register</a> - <a href="#">Forgot Password</a>
          </div>
        </div>
      </div>
</div> 

<div class="container">
    <div class="row">
        <div class="col-md-6">
  <form class="form-horizontal" id="regForm" action='regSubmit' method="POST" data-toggle="validator" role="form">
  <fieldset>
    <div id="legend">
      <legend class="">Register</legend>
    </div>
    <div class="form-group">
      <!-- Username -->
      <label class="control-label"  for="username">Username</label>
      <div class="controls">
        <input type="text" id="username" name="user[name]" required placeholder="" class="form-control" data-minlength="4" pattern="^[A-Za-z0-9 ]*$" data-error="Username can contain any letters or numbers, without spaces"/>
        <p class="help-block with-errors"></p>
      </div>
    </div>
 
    <div class="form-group">
      <!-- E-mail -->
      <label class="control-label" for="email">E-mail</label>
      <div class="controls">
        <input type="email" id="email" name="user[email]" placeholder="" class="form-control" required data-error="Please enter a valid email">
        <p class="help-block with-errors"></p>
      </div>
    </div>
 
    <div class="form-group">
      <!-- Password-->
      <label class="control-label" for="password">Password</label>
      <div class="controls">
        <input type="password" id="password" name="user[password]" placeholder="" class="form-control" required data-minlength="4">
        <p class="help-block with-errors">Password should be at least 4 characters</p>
      </div>
    </div>
 
    <div class="form-group">
      <!-- Password -->
      <label class="control-label"  for="password_confirm">Password (Confirm)</label>
      <div class="controls">
        <input type="password" id="password_confirm" name="user[password_confirm]" placeholder="" class="form-control" required data-match="#password" data-match-error="Passowrds doesnt match">
        <p class="help-block with-errors"></p>
      </div>
    </div>
 
    <div class="form-group">
      <!-- Button -->
      <div class="form-group">
        <button class="btn btn-success register">Register</button>
      </div>
    </div>
  </fieldset>
</form>
</div>
</div>  
</div>


 <footer class="footer">
      <div class="container">
        <p class="text-muted">All rights reserved</p>
      </div>
    </footer>

<!-- jQuery first, then Tether, then Bootstrap JS. -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.0.0/jquery.min.js" integrity="sha384-THPy051/pYDQGanwU6poAc/hOdQxjnOEXzbT+OuUAFqNqFjL+4IGLBgCJC3ZOShY" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.2.0/js/tether.min.js" integrity="sha384-Plbmg8JY28KFelvJVai01l8WyZzrYWG825m+cZ0eDDS1f7d/js6ikvy1+X+guPIB" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.4/js/bootstrap.min.js" integrity="VjEeINv9OSwtWFLAtmc4JCtEJXXBub00gtSnszmspDLCtC0I4z4nqz7rEFbIZLLU" crossorigin="anonymous"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/1000hz-bootstrap-validator/0.9.0/validator.min.js"></script>
</body>
<script type="text/javascript">
  $(document).ready(function(){

    $('.modal').on('shown.bs.modal', function () {
      $(this).find('form').validator('destroy').validator();
      $('#mod-uname').focus();
    });


    $('.register').click(function(event){
      event.preventDefault();

      $.ajax({
        url: 'regValidate',
        type: 'post',
        dataType: 'json',
        data: $('#regForm').serialize(),
        success: function(data) {
                   console.log(data);
                   if(data.status == 'OK'){
                    $('#regForm').submit();
                   }
                 }
    });
    });

    $('#loginSubmit').click(function(event){
          event.preventDefault();
          $.ajax({
            url: '/userLogin',
            type: 'post',
            dataType: 'json',
            data: $('#loginForm').serialize(),
            success: function(data) {
                       console.log(data);
                       if(data.status == 'OK'){
                        $('#login-modal').modal('toggle');
                        $('.login_lnk').hide();
                        $('.reg_link').hide();
                        $('.logout_lnk').show();
                        uid = data.uid;
                        $("#commentBtn").prop("disabled",false);
                        $('input[name="uid"]').val(uid);
                       }
                     }
        });
        });
  });
</script>
</html>
